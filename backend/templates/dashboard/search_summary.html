{% extends 'dashboard/base.html' %}
{% load page_tags %}
{% block stage %}
<div class="space-y-6">
  <!-- Page Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-neutral-900">Daily Search Summary</h1>
      <p class="text-sm text-neutral-500 mt-0.5">Track search trends and patterns</p>
    </div>
  </div>

  <!-- Type Selector -->
  <div class="flex flex-wrap gap-2">
    <a href="{% url 'dashboard:search_summary' 'skills' %}" class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if search_type == 'skills' %}bg-primary-600 text-white{% else %}bg-neutral-100 text-neutral-600 hover:bg-neutral-200{% endif %}">
      <i class="fa fa-code mr-2"></i>Skills
    </a>
    <a href="{% url 'dashboard:search_summary' 'other-skills' %}" class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if search_type == 'other-skills' %}bg-primary-600 text-white{% else %}bg-neutral-100 text-neutral-600 hover:bg-neutral-200{% endif %}">
      <i class="fa fa-tags mr-2"></i>Other Skills
    </a>
    <a href="{% url 'dashboard:search_summary' 'locations' %}" class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if search_type == 'locations' %}bg-primary-600 text-white{% else %}bg-neutral-100 text-neutral-600 hover:bg-neutral-200{% endif %}">
      <i class="fa fa-map-marker mr-2"></i>Locations
    </a>
    <a href="{% url 'dashboard:search_summary' 'other-locations' %}" class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-colors {% if search_type == 'other-locations' %}bg-primary-600 text-white{% else %}bg-neutral-100 text-neutral-600 hover:bg-neutral-200{% endif %}">
      <i class="fa fa-globe mr-2"></i>Other Locations
    </a>
  </div>

  <!-- Search Form -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden">
    <div class="px-6 py-4 border-b border-neutral-200">
      <h3 class="text-lg font-semibold text-neutral-800">
        <i class="fa fa-filter text-primary-500 mr-2"></i>Filter Data
      </h3>
    </div>
    <div class="p-6">
      <form id="search_form" name="adv-search-form" method="POST" action=".">
        <div class="grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
          <div class="md:col-span-5">
            <label class="block text-sm font-medium text-neutral-700 mb-2">Search Values</label>
            <input type="text" class="form-control" id="search" name="search" value="{{ request.POST.search }}" placeholder="Enter values i.e: python, java">
          </div>
          <div class="md:col-span-5">
            <label class="block text-sm font-medium text-neutral-700 mb-2">Date Range</label>
            <input type="text" class="form-control" id="reportrange" name="timestamp" value="{{ request.POST.timestamp }}" placeholder="Select the date" autocomplete="off">
          </div>
          <div class="md:col-span-2">
            <button type="submit" class="btn btn-primary w-full">
              <i class="fa fa-search mr-2"></i>Submit
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Chart -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden">
    <div class="px-6 py-4 border-b border-neutral-200">
      <h3 class="text-lg font-semibold text-neutral-800">
        <i class="fa fa-line-chart text-primary-500 mr-2"></i>Search Trends
      </h3>
    </div>
    <div class="p-6">
      <div id="myChart" class="w-full" style="height: 400px;"></div>
    </div>
  </div>

  <!-- Hidden Data -->
  <div id="values" class="hidden">{{ values|safe }}</div>
  <div id="count" class="hidden">{{ count|safe }}</div>
  <div id="no_of_jobposts" class="hidden">{{ no_of_jobposts|safe }}</div>
</div>
{% endblock stage %}

{% block script %}
<script type="text/javascript">
var recruiter_layout = {
  title: 'Number of Searches',
  autosize: true,
  margin: { t: 50, l: 50, r: 30, b: 50 }
};

var trace1 = {
  x: JSON.parse($('#values').html()),
  y: JSON.parse($('#count').html()),
  mode: 'lines',
  name: 'No Of Searches',
  line: { color: '#6366f1' }
};

var recruiter_data = [trace1];

Plotly.newPlot('myChart', recruiter_data, recruiter_layout, {
  displaylogo: false,
  displayModeBar: false,
  responsive: true
});

$('.pagination li a').click(function(e) {
  e.preventDefault();
  $('#search_form').submit();
});
</script>
{% endblock script %}
