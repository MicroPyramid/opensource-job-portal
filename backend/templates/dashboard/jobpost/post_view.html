{% extends "dashboard/base.html" %}
{% load thumbnail %}
{% load page_tags %}
{% load static %}
{% load tz %}
{% block stage %}
<div class="space-y-6">
  <!-- Page Header -->
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-4">
      <a href="{% url 'dashboard:job_posts' post.job_type %}" class="inline-flex items-center justify-center w-10 h-10 rounded-lg bg-neutral-100 text-neutral-600 hover:bg-neutral-200 transition-colors">
        <i class="fa fa-arrow-left"></i>
      </a>
      <div>
        <h1 class="text-2xl font-semibold text-neutral-900">{{ post.title }}</h1>
        <p class="text-sm text-neutral-500 mt-0.5">Posted on: {{ post.created_on }}</p>
      </div>
    </div>
    <div class="flex items-center gap-2">
      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
        {% if post.status == 'Live' %}bg-green-100 text-green-800
        {% elif post.status == 'Pending' %}bg-yellow-100 text-yellow-800
        {% elif post.status == 'Published' %}bg-blue-100 text-blue-800
        {% elif post.status == 'Draft' %}bg-neutral-100 text-neutral-600
        {% else %}bg-red-100 text-red-800{% endif %}">
        {{ post.status }}
      </span>
      <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800">
        {{ post.job_type|get_string }}
      </span>
    </div>
  </div>

  <!-- Posted By Card -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden">
    <div class="bg-gradient-to-r from-amber-500 to-amber-600 px-6 py-6">
      <div class="flex items-center gap-4">
        <div class="w-16 h-16 rounded-full bg-white shadow-lg flex items-center justify-center overflow-hidden border-4 border-white/30">
          {% if post.user.profile_pic|length > 0 %}
          <img src="{{ post.user.profile_pic.url }}" class="w-full h-full object-cover" alt="{{ post.user.username }}">
          {% elif post.user.photo %}
          <img src="{{ post.user.photo }}" class="w-full h-full object-cover" alt="{{ post.user.username }}">
          {% else %}
          <img src="{% static 'dummy.jpg' %}" class="w-full h-full object-cover" alt="Default">
          {% endif %}
        </div>
        <div>
          <p class="text-amber-100 text-xs uppercase tracking-wider">Posted By</p>
          <h2 class="text-lg font-semibold text-white">{{ post.user.username }}</h2>
          <p class="text-amber-100 text-sm mt-0.5">
            <i class="fa fa-envelope mr-1"></i>{{ post.user.email }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Tabs -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden">
    <!-- Tab Buttons -->
    <div class="border-b border-neutral-200 px-6">
      <div class="flex gap-1">
        <button class="tab-btn px-4 py-3 text-sm font-medium text-primary-600 border-b-2 border-primary-500 transition-colors active" data-tab="post_view">
          <i class="fa fa-list-ul mr-1.5"></i>Post Details
        </button>
        <button class="tab-btn px-4 py-3 text-sm font-medium text-neutral-600 hover:text-primary-600 border-b-2 border-transparent hover:border-primary-300 transition-colors" data-tab="applicants_view">
          <i class="fa fa-users mr-1.5"></i>Applicants
        </button>
      </div>
    </div>

    <!-- Tab Content -->
    <div class="p-6">
      <!-- Post Details Tab -->
      <div class="tab-content active" id="post_view">
        <div class="space-y-6">
          <!-- Job Details -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-briefcase text-primary-500"></i>Job Details
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Job Title</label>
                <p class="text-neutral-900 mt-1 font-medium">{{ post.title }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Job Location</label>
                <p class="text-neutral-900 mt-1">{% for location in post.location.all %}{{ location.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Status</label>
                <p class="mt-1">
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium
                    {% if post.status == 'Live' %}bg-green-100 text-green-800
                    {% elif post.status == 'Pending' %}bg-yellow-100 text-yellow-800
                    {% elif post.status == 'Published' %}bg-blue-100 text-blue-800
                    {% else %}bg-neutral-100 text-neutral-600{% endif %}">{{ post.status }}</span>
                </p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Vacancies</label>
                <p class="text-neutral-900 mt-1">{{ post.vacancies }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Job Type</label>
                <p class="text-neutral-900 mt-1">{{ post.job_type|get_string }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Keywords</label>
                <div class="flex flex-wrap gap-1 mt-1">
                  {% for key in post.keywords.all %}
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-800">{{ key.name }}</span>
                  {% endfor %}
                </div>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-neutral-200">
              <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Job Description</label>
              <div class="text-neutral-700 mt-2 prose prose-sm max-w-none">{{ post.description|safe }}</div>
            </div>
          </div>

          <!-- Eligibility Details -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-filter text-primary-500"></i>Eligibility Details
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Educational Qualification</label>
                <p class="text-neutral-900 mt-1">{% for qualification in post.edu_qualification.all %}{{ qualification.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Experience Required</label>
                <p class="text-neutral-900 mt-1">{{ post.min_year }} Years {{ post.min_month }} Months - {{ post.max_year }} Years {{ post.max_month }} Months</p>
              </div>
              {% if post.visa_required %}
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Visa Country</label>
                <p class="text-neutral-900 mt-1">{{ post.visa_country }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Required Visa Type</label>
                <p class="text-neutral-900 mt-1">{{ post.visa_type }}</p>
              </div>
              {% endif %}
            </div>
            <div class="mt-4 pt-4 border-t border-neutral-200 space-y-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Major Skill</label>
                <div class="mt-1">
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-amber-100 text-amber-800">
                    <i class="fa fa-star mr-1.5 text-xs"></i>{{ post.major_skill.name }}
                  </span>
                </div>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Technical Skills</label>
                <div class="flex flex-wrap gap-2 mt-1">
                  {% for skill in post.get_skills %}
                  <span class="inline-flex items-center px-2 py-1 rounded text-sm bg-primary-50 text-primary-700">{{ skill.name }} <span class="ml-1 text-xs text-primary-500">({{ skill.status }})</span></span>
                  {% endfor %}
                </div>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Industry</label>
                <div class="flex flex-wrap gap-2 mt-1">
                  {% for industry in post.industry.all %}
                  <span class="inline-flex items-center px-2 py-1 rounded text-sm bg-neutral-100 text-neutral-700">{{ industry.name }} <span class="ml-1 text-xs text-neutral-500">({{ industry.status }})</span></span>
                  {% endfor %}
                </div>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Functional Area</label>
                <div class="flex flex-wrap gap-2 mt-1">
                  {% for functional_area in post.functional_area.all %}
                  <span class="inline-flex items-center px-2 py-1 rounded text-sm bg-neutral-100 text-neutral-700">{{ functional_area.name }} <span class="ml-1 text-xs text-neutral-500">({{ functional_area.status }})</span></span>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>

          <!-- Company Details -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-building text-primary-500"></i>Company Details
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Company Name</label>
                <p class="text-neutral-900 mt-1 font-medium">{% if post.company %}{{ post.company.name }}{% else %}{{ post.company_name }}{% endif %}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Company Address</label>
                <p class="text-neutral-900 mt-1">{% if post.company %}{{ post.company.address|default:"Not Specified" }}{% else %}{{ post.company_address|default:"Not Specified" }}{% endif %}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Company Emails</label>
                <p class="text-neutral-900 mt-1">{{ post.company_emails|default:"Not Specified" }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Company Links</label>
                <p class="text-neutral-900 mt-1 break-all">{{ post.company_links|default:"Not Specified" }}</p>
              </div>
            </div>
            <div class="mt-4 pt-4 border-t border-neutral-200">
              <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Company Description</label>
              <div class="text-neutral-700 mt-2 prose prose-sm max-w-none">{% if post.company %}{{ post.company.profile|safe|default:"Not Specified" }}{% else %}{{ post.company_description|default:"Not Specified" }}{% endif %}</div>
            </div>
            {% if post.selection_process %}
            <div class="mt-4 pt-4 border-t border-neutral-200">
              <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Selection Process</label>
              <div class="text-neutral-700 mt-2 prose prose-sm max-w-none">{{ post.selection_process|safe }}</div>
            </div>
            {% endif %}
            {% if post.how_to_apply %}
            <div class="mt-4 pt-4 border-t border-neutral-200">
              <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">How To Apply</label>
              <div class="text-neutral-700 mt-2 prose prose-sm max-w-none">{{ post.how_to_apply|safe }}</div>
            </div>
            {% endif %}
          </div>

          {% if post.job_interview_location.all %}
          <!-- Interview Location -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-map-marker-alt text-primary-500"></i>Interview Locations
            </h4>
            <div class="space-y-3">
              {% for location in post.job_interview_location.all %}
              {% if location.venue_details %}
              <div class="bg-white rounded-lg p-4 border border-neutral-200">
                <span class="text-xs font-medium text-neutral-500">Venue {{ forloop.counter }}</span>
                <p class="text-neutral-900 mt-1">{{ location.venue_details }}</p>
              </div>
              {% endif %}
              {% endfor %}
            </div>
          </div>
          {% endif %}

          {% if post.job_type == 'walk-in' %}
          <!-- Walk-in Details -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-walking text-primary-500"></i>Walk-in Details
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Contact Info</label>
                <p class="text-neutral-900 mt-1">{{ post.walkin_contactinfo }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Show Contact Info</label>
                <p class="mt-1">
                  {% if post.walkin_show_contact_info %}
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800">Yes</span>
                  {% else %}
                  <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800">No</span>
                  {% endif %}
                </p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Walk-in Dates</label>
                <p class="text-neutral-900 mt-1">{{ post.walkin_from_date }} - {{ post.walkin_to_date }}</p>
              </div>
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Walk-in Time</label>
                <p class="text-neutral-900 mt-1">{{ post.walkin_time }}</p>
              </div>
            </div>
          </div>
          {% endif %}

          <!-- Offering Details -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-money-bill text-primary-500"></i>Offering Details
            </h4>
            <div>
              <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Salary</label>
              <p class="text-neutral-900 mt-1 text-lg font-medium">
                {% if post.min_salary == 0 and post.max_salary == 0 %}
                Not Specified
                {% else %}
                <i class="fa fa-inr text-sm"></i> {{ post.get_job_salary.0 }} - {{ post.get_job_salary.1 }} P.A
                {% endif %}
              </p>
            </div>
          </div>

          <!-- Dates -->
          <div class="bg-neutral-50 rounded-lg p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-calendar text-primary-500"></i>Important Dates
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Published On</label>
                <p class="text-neutral-900 mt-1">{{ post.published_date }}</p>
              </div>
              {% if post.govt_from_date %}
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Application From Date</label>
                <p class="text-neutral-900 mt-1">{{ post.govt_from_date }}</p>
              </div>
              {% endif %}
              {% if post.govt_to_date %}
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Application To Date</label>
                <p class="text-neutral-900 mt-1">{{ post.govt_to_date }}</p>
              </div>
              {% endif %}
              {% if post.govt_exam_date %}
              <div>
                <label class="text-xs font-medium text-neutral-500 uppercase tracking-wider">Exam Date</label>
                <p class="text-neutral-900 mt-1">{{ post.govt_exam_date }}</p>
              </div>
              {% endif %}
            </div>
          </div>

          <!-- Admin Comments & Actions -->
          <div class="bg-white rounded-lg border border-neutral-200 p-5">
            <h4 class="text-sm font-semibold text-neutral-800 mb-4 flex items-center gap-2">
              <i class="fa fa-comment text-primary-500"></i>Admin Comments
            </h4>
            <form action="{% url 'dashboard:mail_to_recruiter' post.id %}" method="post">
              {% csrf_token %}
              <textarea name="comments" id="description" rows="4" placeholder="Leave comments to recruiter..."
                class="form-control mb-4"></textarea>
              <div class="flex items-center gap-3">
                <button type="submit" class="btn btn-secondary">
                  <i class="fa fa-comment mr-2"></i>Send Comment
                </button>
                <a href="{% url 'dashboard:publish' post.id %}" class="btn btn-primary">
                  <i class="fa fa-check mr-2"></i>Publish
                </a>
                <a href="{% url 'dashboard:job_posts' post.job_type %}" class="btn btn-secondary">
                  <i class="fa fa-times mr-2"></i>Cancel
                </a>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Applicants Tab -->
      <div class="tab-content hidden" id="applicants_view">
        <!-- Sub Tabs -->
        <div class="border-b border-neutral-200 mb-6">
          <div class="flex gap-1">
            <button class="sub-tab-btn px-4 py-2 text-sm font-medium text-primary-600 border-b-2 border-primary-500 transition-colors active" data-subtab="normal_applicants">
              <i class="fa fa-user mr-1.5"></i>Normal Applicants
            </button>
            <button class="sub-tab-btn px-4 py-2 text-sm font-medium text-neutral-600 hover:text-primary-600 border-b-2 border-transparent hover:border-primary-300 transition-colors" data-subtab="resume_applicants">
              <i class="fa fa-file mr-1.5"></i>Resume Applicants
            </button>
            <button class="sub-tab-btn px-4 py-2 text-sm font-medium text-neutral-600 hover:text-primary-600 border-b-2 border-transparent hover:border-primary-300 transition-colors" data-subtab="manual_applicants">
              <i class="fa fa-user-plus mr-1.5"></i>Manual Applicants
            </button>
          </div>
        </div>

        <!-- Normal Applicants -->
        <div class="sub-tab-content active" id="normal_applicants">
          {% if applicants %}
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-neutral-50 border-b border-neutral-200">
                <tr>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider w-12">#</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Email</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Name</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Mobile</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Status</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-neutral-100">
                {% for user in applicants %}
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 text-neutral-500">{{ forloop.counter }}</td>
                  <td class="px-4 py-3 text-primary-600">{{ user.user.email }}</td>
                  <td class="px-4 py-3 text-neutral-900">{{ user.user.get_full_name }}</td>
                  <td class="px-4 py-3 text-neutral-600">{{ user.user.mobile }}</td>
                  <td class="px-4 py-3">
                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-neutral-100 text-neutral-700">{{ user.status }}</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center py-12">
            <i class="fa fa-users text-4xl text-neutral-300 mb-3"></i>
            <p class="text-neutral-500">No applied users</p>
          </div>
          {% endif %}
        </div>

        <!-- Resume Applicants -->
        <div class="sub-tab-content hidden" id="resume_applicants">
          {% if resumes %}
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-neutral-50 border-b border-neutral-200">
                <tr>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider w-12">#</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Email</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Uploaded By</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Mobile</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Status</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-neutral-100">
                {% for resume in resumes %}
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 text-neutral-500">{{ forloop.counter }}</td>
                  <td class="px-4 py-3 text-primary-600">{{ resume.resume_applicant.email }}</td>
                  <td class="px-4 py-3 text-neutral-900">{{ resume.resume_applicant.uploaded_by }}</td>
                  <td class="px-4 py-3 text-neutral-600">{{ resume.resume_applicant.mobile }}</td>
                  <td class="px-4 py-3">
                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-neutral-100 text-neutral-700">{{ resume.status }}</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center py-12">
            <i class="fa fa-file text-4xl text-neutral-300 mb-3"></i>
            <p class="text-neutral-500">No resumes found</p>
          </div>
          {% endif %}
        </div>

        <!-- Manual Applicants -->
        <div class="sub-tab-content hidden" id="manual_applicants">
          {% if manual_users %}
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-neutral-50 border-b border-neutral-200">
                <tr>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider w-12">#</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Email</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Name</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Mobile</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 text-xs uppercase tracking-wider">Status</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-neutral-100">
                {% for user in manual_users %}
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 text-neutral-500">{{ forloop.counter }}</td>
                  <td class="px-4 py-3 text-primary-600">{{ user.user.email }}</td>
                  <td class="px-4 py-3 text-neutral-900">{{ user.user.get_full_name }}</td>
                  <td class="px-4 py-3 text-neutral-600">{{ user.user.mobile }}</td>
                  <td class="px-4 py-3">
                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-neutral-100 text-neutral-700">{{ user.status }}</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <div class="text-center py-12">
            <i class="fa fa-user-plus text-4xl text-neutral-300 mb-3"></i>
            <p class="text-neutral-500">No manual users</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Hidden data for maps -->
<div id="map_data" class="hidden">{{ locations|safe }}</div>
<div id="venue_data" class="hidden">{{ venue_details|safe }}</div>
{% endblock %}

{% block script %}
<script>
$(document).ready(function(e) {
  // Main tabs
  $('.tab-btn').click(function(e) {
    $('.tab-btn').removeClass('active text-primary-600 border-primary-500').addClass('text-neutral-600 border-transparent');
    $(this).addClass('active text-primary-600 border-primary-500').removeClass('text-neutral-600 border-transparent');

    var tabId = $(this).data('tab');
    $('.tab-content').addClass('hidden').removeClass('active');
    $('#' + tabId).removeClass('hidden').addClass('active');
  });

  // Sub tabs
  $('.sub-tab-btn').click(function(e) {
    $('.sub-tab-btn').removeClass('active text-primary-600 border-primary-500').addClass('text-neutral-600 border-transparent');
    $(this).addClass('active text-primary-600 border-primary-500').removeClass('text-neutral-600 border-transparent');

    var subtabId = $(this).data('subtab');
    $('.sub-tab-content').addClass('hidden').removeClass('active');
    $('#' + subtabId).removeClass('hidden').addClass('active');
  });
});
</script>
{% endblock %}
