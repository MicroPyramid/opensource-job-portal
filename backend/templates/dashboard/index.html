{% extends 'dashboard/base.html' %}
{% load page_tags %}
{% load static %}
{% block stage %}
<style type="text/css">
  .js-plotly-plot .plotly svg {
    overflow: visible !important;
  }
</style>

<div class="space-y-6">
  <!-- Page Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-semibold text-neutral-900">Dashboard</h1>
      <p class="text-sm text-neutral-500 mt-1">Overview of your job portal statistics</p>
    </div>
  </div>

  <!-- Main Stats Card -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm overflow-hidden">
    <!-- Tab Navigation -->
    <div class="border-b border-neutral-200">
      <nav class="flex" role="tablist">
        <button type="button"
                class="tab-btn active px-6 py-4 text-sm font-medium text-neutral-600 hover:text-neutral-900 border-b-2 border-transparent hover:border-neutral-300 transition-all"
                data-tab="statistics"
                role="tab">
          <i class="fa fa-chart-pie mr-2"></i>Statistics
        </button>
        <button type="button"
                class="tab-btn px-6 py-4 text-sm font-medium text-neutral-600 hover:text-neutral-900 border-b-2 border-transparent hover:border-neutral-300 transition-all"
                data-tab="graphs"
                id="graph_click"
                role="tab">
          <i class="fa fa-chart-line mr-2"></i>Graphs
        </button>
      </nav>
    </div>

    <!-- Tab Content -->
    <div class="p-6">
      <!-- Statistics Tab -->
      <div id="tab-statistics" class="tab-panel">
        <!-- Date Filter -->
        <form id="search_form" name="adv-search-form" method="POST" action="." class="mb-6">
          <div class="flex flex-wrap items-center gap-4 justify-end">
            <input type="hidden" name="job_type" id="job_type" value="{{ job_type }}"/>
            <input type="hidden" name="page" id="page" value="{{ page }}"/>
            <div class="flex items-center gap-3">
              <div class="relative">
                <input type="text"
                       class="form-control w-64 pl-10"
                       id="reportrange"
                       name="timestamp"
                       value="{{request.POST.timestamp}}"
                       placeholder="Select date range">
                <i class="fa fa-calendar absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
              </div>
              <button type="submit" class="btn btn-primary">
                <i class="fa fa-search mr-2"></i>Filter
              </button>
            </div>
          </div>
        </form>

        <!-- Job Posts Section -->
        <div class="mb-8">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-neutral-800">Job Posts</h2>
            <div class="flex items-center gap-4 text-xs">
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-yellow-500"></span> Pending</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-blue-500"></span> Published</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-green-500"></span> Live</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-red-500"></span> Deleted</span>
            </div>
          </div>

          <div class="overflow-x-auto rounded-lg border border-neutral-200">
            <table class="w-full text-sm">
              <thead class="bg-neutral-50 border-b border-neutral-200">
                <tr>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 w-1/5"></th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700">Today Recruiter's JobPosts</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700">Today Admin JobPosts</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700">Total</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-neutral-100">
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Jobposts</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_admin_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_admin_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_admin_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_admin_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ total_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ total_published_jobs }}</span>
                      <span class="stat-badge green">{{ total_live_jobs }}</span>
                      <span class="stat-badge red">{{ total_disabled_jobs }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Full Time Jobs</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_fulltime_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_fulltime_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_fulltime_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_fulltime_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_admin_full_time_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_admin_full_time_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_admin_full_time_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_admin_full_time_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{total_fulltime_pending_jobs}}</span>
                      <span class="stat-badge blue">{{total_fulltime_published_jobs}}</span>
                      <span class="stat-badge green">{{total_fulltime_live_jobs}}</span>
                      <span class="stat-badge red">{{total_fulltime_disabled_jobs}}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Internship</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_internship_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_internship_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_internship_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_internship_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_admin_internship_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_admin_internship_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_admin_internship_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_admin_internship_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{total_internship_pending_jobs}}</span>
                      <span class="stat-badge blue">{{total_internship_published_jobs}}</span>
                      <span class="stat-badge green">{{total_internship_live_jobs}}</span>
                      <span class="stat-badge red">{{total_internship_disabled_jobs}}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Walkins</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_walkin_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_walkin_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_walkin_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_walkin_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_admin_walkin_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_admin_walkin_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_admin_walkin_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_admin_walkin_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ total_walkin_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ total_walkin_published_jobs }}</span>
                      <span class="stat-badge green">{{ total_walkin_live_jobs }}</span>
                      <span class="stat-badge red">{{ total_walkin_disabled_jobs }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Government</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_govt_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_govt_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_govt_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_govt_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ today_govt_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ today_govt_published_jobs }}</span>
                      <span class="stat-badge green">{{ today_govt_live_jobs }}</span>
                      <span class="stat-badge red">{{ today_govt_disabled_jobs }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge yellow">{{ total_govt_pending_jobs }}</span>
                      <span class="stat-badge blue">{{ total_govt_published_jobs }}</span>
                      <span class="stat-badge green">{{ total_govt_live_jobs }}</span>
                      <span class="stat-badge red">{{ total_govt_disabled_jobs }}</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Users Section -->
        <div>
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-neutral-800">Users</h2>
            <div class="flex flex-wrap items-center gap-4 text-xs">
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-orange-500"></span> Total</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-green-500"></span> Active / Open / Resume</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-red-500"></span> Inactive / Closed / Applied</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-emerald-600"></span> Verified / Completed</span>
              <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-rose-600"></span> Not Verified / Once</span>
            </div>
          </div>

          <div class="overflow-x-auto rounded-lg border border-neutral-200">
            <table class="w-full text-sm">
              <thead class="bg-neutral-50 border-b border-neutral-200">
                <tr>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700 w-2/5"></th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700">Today</th>
                  <th class="px-4 py-3 text-left font-semibold text-neutral-700">Total</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-neutral-100">
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Job Seekers Through Social Logins</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ today_social_applicants }}</span>
                      <span class="stat-badge green">{{ today_social_resume_applicants }}</span>
                      <span class="stat-badge red">{{ today_social_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ today_social_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ today_social_login_once_applicants }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ total_social_applicants }}</span>
                      <span class="stat-badge green">{{ social_resume_applicants}}</span>
                      <span class="stat-badge red">{{ social_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ social_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ social_login_once_applicants }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Job Seekers Through Normal Registrations</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ today_register_applicants }}</span>
                      <span class="stat-badge green">{{ today_register_resume_applicants }}</span>
                      <span class="stat-badge red">{{ today_register_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ today_register_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ today_register_login_once_applicants }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ total_register_applicants|length }}</span>
                      <span class="stat-badge green">{{ register_resume_applicants }}</span>
                      <span class="stat-badge red">{{ register_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ register_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ register_login_once_applicants }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Job Seekers Through Resumes</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ today_resume_applicants }}</span>
                      <span class="stat-badge green">{{ today_resume_applicants }}</span>
                      <span class="stat-badge red">{{ today_resume_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ today_resume_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ today_resume_login_once_applicants }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ resume_applicants }}</span>
                      <span class="stat-badge green">{{ resume_applicants }}</span>
                      <span class="stat-badge red">{{ resume_applied_applicants }}</span>
                      <span class="stat-badge emerald">{{ resume_profile_applicants }}</span>
                      <span class="stat-badge rose">{{ resume_login_once_applicants }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Agencies</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ today_agency_recruiters_count }}</span>
                      <span class="stat-badge green">{{ today_agency_active_recruiters_count }}</span>
                      <span class="stat-badge red">{{ today_agency_inactive_recruiters_count }}</span>
                      <span class="stat-badge emerald">{{ today_agency_mobile_verified_recruiters_count }}</span>
                      <span class="stat-badge rose">{{ today_agency_mobile_not_verified_recruiters_count }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ total_agency_recruiters_count }}</span>
                      <span class="stat-badge green">{{ total_agency_active_recruiters_count }}</span>
                      <span class="stat-badge red">{{ total_agency_inactive_recruiters_count }}</span>
                      <span class="stat-badge emerald">{{ total_agency_mobile_verified_recruiters_count }}</span>
                      <span class="stat-badge rose">{{ total_agency_mobile_not_verified_recruiters_count }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Recruiters</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ today_recruiters_count }}</span>
                      <span class="stat-badge green">{{ today_active_recruiters_count }}</span>
                      <span class="stat-badge red">{{ today_inactive_recruiters_count }}</span>
                      <span class="stat-badge emerald">{{ today_recruiters_mobile_verified_count }}</span>
                      <span class="stat-badge rose">{{ today_recruiters_mobile_not_verified_count }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5 flex-wrap">
                      <span class="stat-badge orange">{{ total_recruiters }}</span>
                      <span class="stat-badge green">{{ total_active_recruiters_count }}</span>
                      <span class="stat-badge red">{{ total_inactive_recruiters_count }}</span>
                      <span class="stat-badge emerald">{{ total_recruiters_mobile_verified_count }}</span>
                      <span class="stat-badge rose">{{ total_recruiters_mobile_not_verified_count }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Job Applications</td>
                  <td class="px-4 py-3"><span class="stat-badge green">{{ today_job_applications }}</span></td>
                  <td class="px-4 py-3"><span class="stat-badge green">{{ total_job_applications }}</span></td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Skills</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ today_active_skills }}</span>
                      <span class="stat-badge red">{{ today_inactive_skills }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge orange">{{ total_skills }}</span>
                      <span class="stat-badge green">{{ total_active_skills }}</span>
                      <span class="stat-badge red">{{ total_inactive_skills }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Locations</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ today_active_locations }}</span>
                      <span class="stat-badge red">{{ today_inactive_locations }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge orange">{{ total_locations }}</span>
                      <span class="stat-badge green">{{ total_active_locations }}</span>
                      <span class="stat-badge red">{{ total_inactive_locations }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">User Locations</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ today_active_user_locations }}</span>
                      <span class="stat-badge red">{{ today_inactive_user_locations }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge orange">{{ total_user_locations }}</span>
                      <span class="stat-badge green">{{ total_active_user_locations }}</span>
                      <span class="stat-badge red">{{ total_inactive_user_locations }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Companies</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ today_companies_active }}</span>
                      <span class="stat-badge red">{{ today_companies_not_active }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge orange">{{ total_companies }}</span>
                      <span class="stat-badge green">{{ total_active_companies }}</span>
                      <span class="stat-badge red">{{ total_inactive_companies }}</span>
                    </div>
                  </td>
                </tr>
                <tr class="hover:bg-neutral-50 transition-colors">
                  <td class="px-4 py-3 font-medium text-neutral-800">Tickets</td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ today_tickets_open }}</span>
                      <span class="stat-badge red">{{ today_tickets_closed }}</span>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex gap-1.5">
                      <span class="stat-badge green">{{ total_tickets_open }}</span>
                      <span class="stat-badge red">{{ total_tickets_closed }}</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Graphs Tab -->
      <div id="tab-graphs" class="tab-panel hidden">
        <!-- Graph Filter -->
        <form id="graph_search_form" name="graph_search_form" method="POST" action="." class="mb-6">
          <div class="flex flex-wrap items-center gap-4 justify-end">
            <select name="year" id="year" class="form-select w-32">
              <option value="2017" selected>2017</option>
              <option value="2016" {% if request.POST.year|slugify == '2016' %}selected{% endif %}>2016</option>
              <option value="2015" {% if request.POST.year|slugify == '2015' %}selected{% endif %}>2015</option>
            </select>
            <select name="month" id="month" class="form-select w-48">
              <option value="">Select A Month</option>
              {% for month in months %}
                <option value="{{ month.id }}" {% if request.POST.month|slugify == month.id|slugify %}selected{% endif %}>{{ month.Name }}</option>
              {% endfor %}
            </select>
            <button type="submit" class="btn btn-primary">
              <i class="fa fa-filter mr-2"></i>Apply
            </button>
          </div>
        </form>

        <!-- Graph Navigation -->
        <div class="flex gap-6">
          <!-- Vertical Tabs -->
          <div class="w-48 flex-shrink-0">
            <nav class="flex flex-col gap-1">
              <button type="button" class="graph-tab-btn active text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="recruiters">
                Recruiters
              </button>
              <button type="button" class="graph-tab-btn text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="social-applicants">
                Social Login Applicants
              </button>
              <button type="button" class="graph-tab-btn text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="registered-applicants">
                Registered Applicants
              </button>
              <button type="button" class="graph-tab-btn text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="all-applicants">
                All Applicants
              </button>
              <button type="button" class="graph-tab-btn text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="jobposts">
                Job Posts
              </button>
              <button type="button" class="graph-tab-btn text-left px-4 py-2.5 text-sm font-medium rounded-lg transition-colors" data-graph="emails">
                Email Bounces
              </button>
            </nav>
          </div>

          <!-- Graph Content -->
          <div class="flex-1 min-w-0">
            <div id="graph-recruiters" class="graph-panel">
              <div id="myChart" class="w-full h-[500px]"></div>
            </div>
            <div id="graph-social-applicants" class="graph-panel hidden">
              <div id="social-applicant-chart" class="w-full h-[500px]"></div>
            </div>
            <div id="graph-registered-applicants" class="graph-panel hidden">
              <div id="register-applicant-chart" class="w-full h-[500px]"></div>
            </div>
            <div id="graph-all-applicants" class="graph-panel hidden">
              <div id="all-applicant-chart" class="w-full h-[500px]"></div>
            </div>
            <div id="graph-jobposts" class="graph-panel hidden">
              <div id="jobpostChart" class="w-full h-[500px]"></div>
            </div>
            <div id="graph-emails" class="graph-panel hidden">
              <div id="emailsChart" class="w-full h-[500px]"></div>
            </div>
          </div>
        </div>

        <!-- Hidden Data -->
        <div class="hidden">
          <div id="all_dates">{{ all_dates|safe }}</div>
          <div id="active_recruiters">{{ all_active_recruiters|safe }}</div>
          <div id="inactive_recruiters">{{ all_inactive_recruiters|safe }}</div>
          <div id="agency_active_recruiters">{{ all_agency_active_recruiters|safe }}</div>
          <div id="agency_inactive_recruiters">{{ all_agency_inactive_recruiters|safe }}</div>
          <div id="all_active_applicants">{{ all_active_applicants|safe }}</div>
          <div id="all_resume_uploaded_applicants">{{ all_resume_upload_candidates|safe }}</div>
          <div id="all_profile_completed_applicants">{{ all_profile_completed_candidates|safe }}</div>
          <div id="all_applied_jobs_applicants">{{ all_appliedto_job_candidates|safe }}</div>
          <div id="all_login_once_applicants">{{ all_login_once_candidates|safe }}</div>
          <div id="all_social_applicants">{{ social_active_applicants|safe }}</div>
          <div id="all_register_applicants">{{ all_register_active_applicants|safe }}</div>
          <div id="social_active_applicants">{{ social_active_applicants|safe }}</div>
          <div id="social_resume_uploaded_applicants">{{ social_resume_upload_candidates|safe }}</div>
          <div id="social_profile_completed_applicants">{{ social_profile_completed_candidates|safe }}</div>
          <div id="social_applied_jobs_applicants">{{ social_appliedto_job_candidates|safe }}</div>
          <div id="social_login_once_applicants">{{ social_login_once_candidates|safe }}</div>
          <div id="active_register_applicants">{{ all_register_active_applicants|safe }}</div>
          <div id="all_register_resume_uploaded_applicants">{{ all_register_resume_upload_candidates|safe }}</div>
          <div id="all_register_profile_completed_applicants">{{ all_register_profile_completed_candidates|safe }}</div>
          <div id="all_register_applied_jobs_applicants">{{ all_register_appliedto_job_candidates|safe }}</div>
          <div id="all_register_login_once_applicants">{{ all_register_login_once_candidates|safe }}</div>
          <div id="all_govt">{{ all_govt|safe }}</div>
          <div id="all_full_time">{{ all_full_time|safe }}</div>
          <div id="all_walkin">{{ all_walkin|safe }}</div>
          <div id="all_internship">{{ all_internship|safe }}</div>
          <div id="all_bounce">{{ all_bounce|safe }}</div>
        </div>
      </div>
    </div>
  </div>

  {% if comments %}
  <!-- Comments Section -->
  <div class="bg-white rounded-xl border border-neutral-200 shadow-sm p-6">
    <h3 class="text-lg font-semibold text-neutral-800 mb-4">Recent Comments</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {% for comment in comments %}
      <div class="p-4 rounded-lg border border-neutral-200 hover:border-neutral-300 transition-colors">
        <div class="text-xs text-neutral-500 mb-1">02/08/08</div>
        <div class="font-medium text-neutral-800 mb-1">{{comment.ticket.title}}</div>
        <div class="text-sm text-neutral-600">{{comment.commented_by.email}}</div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>

<style type="text/tailwindcss">
  @layer components {
    .stat-badge {
      @apply inline-flex items-center justify-center min-w-[28px] px-2 py-1 text-xs font-semibold rounded;
    }
    .stat-badge.yellow { @apply bg-yellow-100 text-yellow-800; }
    .stat-badge.blue { @apply bg-blue-100 text-blue-800; }
    .stat-badge.green { @apply bg-green-100 text-green-800; }
    .stat-badge.red { @apply bg-red-100 text-red-800; }
    .stat-badge.orange { @apply bg-orange-100 text-orange-800; }
    .stat-badge.emerald { @apply bg-emerald-100 text-emerald-800; }
    .stat-badge.rose { @apply bg-rose-100 text-rose-800; }

    .tab-btn.active {
      @apply text-primary-600 border-primary-500;
    }

    .graph-tab-btn {
      @apply text-neutral-600 hover:bg-neutral-100;
    }
    .graph-tab-btn.active {
      @apply bg-primary-50 text-primary-700;
    }
  }
</style>
{% endblock stage %}

{% block script %}
<script>
// Tab switching
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    this.classList.add('active');

    document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
    document.getElementById('tab-' + this.dataset.tab).classList.remove('hidden');
  });
});

// Graph tab switching
document.querySelectorAll('.graph-tab-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.graph-tab-btn').forEach(b => b.classList.remove('active'));
    this.classList.add('active');

    document.querySelectorAll('.graph-panel').forEach(p => p.classList.add('hidden'));
    document.getElementById('graph-' + this.dataset.graph).classList.remove('hidden');
  });
});

{% if request.POST.month %}
document.getElementById('graph_click').click();
{% endif %}

// Plotly Charts
var trace1 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#active_recruiters').html() || '[]'),
  mode: 'lines',
  name: 'Active Recruiters'
};

var trace2 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#inactive_recruiters').html() || '[]'),
  mode: 'lines',
  name: 'In Active Recruiters'
};

var trace3 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#agency_active_recruiters').html() || '[]'),
  mode: 'lines',
  name: 'Agency Active Recruiters'
};

var trace4 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#agency_inactive_recruiters').html() || '[]'),
  mode: 'lines',
  name: 'Agency In Active Recruiters'
};
var recruiter_data = [trace1, trace2, trace3, trace4];

var applicants = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_active_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Total Applicants'
};

var applicants1 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_resume_uploaded_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Resume Uploaded Applicants'
};

var applicants2 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_applied_jobs_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Applied To Job Applicants'
};

var applicants3 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_login_once_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Login only once applicants'
};

var applicants4 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_profile_completed_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Profile Completed Applicants'
};

var applicants5 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_social_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Social Applicants'
};

var applicants6 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_register_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Registered Applicants'
};

var applicant_data = [applicants, applicants1, applicants2, applicants3, applicants4, applicants5, applicants6];

var register_applicants = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#active_register_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Total Applicants'
};

var register_applicants1 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_register_resume_uploaded_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Resume Uploaded Applicants'
};

var register_applicants2 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_register_applied_jobs_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Applied To Job Applicants'
};

var register_applicants3 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_register_login_once_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Login only once applicants'
};

var register_applicants4 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_register_profile_completed_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Profile Completed Applicants'
};

var register_applicant_data = [register_applicants, register_applicants1, register_applicants2, register_applicants3, register_applicants4];

var social_applicants = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#social_active_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Total Applicants'
};

var social_applicants1 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#social_resume_uploaded_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Resume Uploaded Applicants'
};

var social_applicants2 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#social_applied_jobs_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Applied To Job Applicants'
};

var social_applicants3 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#social_login_once_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Login only once applicants'
};

var social_applicants4 = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#social_profile_completed_applicants').html() || '[]'),
  mode: 'lines',
  name: 'Profile Completed Applicants'
};

var social_applicant_data = [social_applicants, social_applicants1, social_applicants2, social_applicants3, social_applicants4];

var full_time = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_full_time').html() || '[]'),
  mode: 'lines',
  name: 'Full Time Jobposts'
};

var walk_in = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_walkin').html() || '[]'),
  mode: 'lines',
  name: 'Walkin Jobposts'
};

var govt = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_govt').html() || '[]'),
  mode: 'lines',
  name: 'Government Jobposts'
};

var internship = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_internship').html() || '[]'),
  mode: 'lines',
  name: 'Internship Jobposts'
};

var jobposts_data = [full_time, walk_in, govt, internship];

var bounces = {
  x: JSON.parse($('#all_dates').html() || '[]'),
  y: JSON.parse($('#all_bounce').html() || '[]'),
  mode: 'lines',
  name: 'No of Bounced Emails'
};

var emails_data = [bounces];

var chartLayout = {
  height: 500,
  margin: { t: 40, r: 40, b: 40, l: 60 },
  font: { family: 'Inter, system-ui, sans-serif' }
};

var chartConfig = {
  displaylogo: false,
  displayModeBar: false,
  responsive: true
};

Plotly.newPlot('myChart', recruiter_data, { ...chartLayout, title: 'Number of Recruiters' }, chartConfig);
Plotly.newPlot('jobpostChart', jobposts_data, { ...chartLayout, title: 'Number of Job Posts' }, chartConfig);
Plotly.newPlot('all-applicant-chart', applicant_data, { ...chartLayout, title: 'Number of Applicants Through All Registrations' }, chartConfig);
Plotly.newPlot('register-applicant-chart', register_applicant_data, { ...chartLayout, title: 'Number of Applicants Through Registrations' }, chartConfig);
Plotly.newPlot('social-applicant-chart', social_applicant_data, { ...chartLayout, title: 'Number of Applicants Through Social Logins' }, chartConfig);
Plotly.newPlot('emailsChart', emails_data, { ...chartLayout, title: 'Number of Emails' }, chartConfig);
</script>
{% endblock script %}
